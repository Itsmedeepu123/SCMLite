{% extends "base1.html" %}

{% block title %}Edit User{% endblock %}

{% block content %}
<link rel="stylesheet" href="{{ url_for('static', path='edit_user.css') }}">

<h2>Edit User</h2>
<form method="post" action="/edit_user/{{ user._id }}" class="edit-form">
    <label>Name:</label>
    <input type="text" name="name" value="{{ user.name }}" required>

    <label>Email:</label>
    <input type="email" name="email" value="{{ user.email }}" required>

    <label>Role:</label>
    <select name="role" required>
        <option value="user" {% if user.role == 'user' %}selected{% endif %}>User</option>
        <option value="admin" {% if user.role == 'admin' %}selected{% endif %}>Admin</option>
    </select>

    <button type="submit" class="btn-edit">Update User</button>
</form>

<script>
    // Redirect non-admin users away from this page
    document.addEventListener('DOMContentLoaded', function() {
        // Get user role from cookie
        const userRole = getCookie('user_role');
        
        // If user is not admin, redirect to dashboard
        if (userRole !== 'admin') {
            alert('Access denied. Admin privileges required.');
            window.location.href = '/dashboard';
        }
    });
    
    // Utility function to get cookie value
    function getCookie(name) {
        const value = `; ${document.cookie}`;
        const parts = value.split(`; ${name}=`);
        if (parts.length === 2) return parts.pop().split(';').shift();
        return null;
    }
</script>
{% endblock %}
